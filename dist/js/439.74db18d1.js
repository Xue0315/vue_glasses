"use strict";(self["webpackChunkvue_glasses"]=self["webpackChunkvue_glasses"]||[]).push([[439],{6769:function(t,e,l){l.d(e,{Z:function(){return O}});var a=l(3396),s=l(7139);const d={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},r={class:"modal-dialog"},n={class:"modal-content"},o={class:"modal-header bg-danger text-white"},i={class:"modal-title"},u=(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),c={class:"modal-body"},p={key:0},_={class:"text-danger"},g={key:1},m={class:"text-danger"},h={class:"modal-footer"},b=(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function w(t,e,l,w,f,y){return(0,a.wg)(),(0,a.iD)("div",d,[(0,a._)("div",r,[(0,a._)("div",n,[(0,a._)("div",o,[(0,a._)("h5",i,[(0,a._)("span",null,"刪除 "+(0,s.zw)(l.product.title),1)]),u]),(0,a._)("div",c,[l.product.title?((0,a.wg)(),(0,a.iD)("div",p,[(0,a.Uk)("是否刪除 "),(0,a._)("strong",_,(0,s.zw)(l.product.title),1),(0,a.Uk)(" (刪除後將無法恢復)。")])):((0,a.wg)(),(0,a.iD)("div",g,[(0,a.Uk)("是否刪除 "),(0,a._)("strong",m,(0,s.zw)(l.product.id),1),(0,a.Uk)(" (刪除後將無法恢復)。")]))]),(0,a._)("div",h,[b,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=e=>t.$emit("delete-product",l.product.id))},"確定")])])])],512)}var f=l(1933),y={data(){return{modal:{}}},props:{product:{}},mixins:[f.Z]},v=l(89);const k=(0,v.Z)(y,[["render",w]]);var O=k},2534:function(t,e,l){l.d(e,{Z:function(){return _}});var a=l(3396),s=l(7139),d=l(9242);const r={"aria-label":"Page navigation example"},n={class:"pagination justify-content-center"},o=["onClick"];function i(t,e,l,i,u,c){return(0,a.wg)(),(0,a.iD)("nav",r,[(0,a._)("ul",n,[(0,a._)("li",{class:(0,s.C_)(["page-item",{disabled:!l.pages.has_pre}])},[(0,a._)("a",{class:"page-link",href:"#",onClick:e[0]||(e[0]=(0,d.iM)((t=>c.updatePage(l.pages.current_page-1)),["prevent"]))},"Previous")],2),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.pages.total_pages,((t,e)=>((0,a.wg)(),(0,a.iD)("li",{key:e,class:"page-item"},[(0,a._)("a",{class:(0,s.C_)(["page-link",{disabled:t===l.pages.current_page}]),href:"#",onClick:(0,d.iM)((e=>c.updatePage(t)),["prevent"])},(0,s.zw)(t),11,o)])))),128)),(0,a._)("li",{class:(0,s.C_)(["page-item",{disabled:!l.pages.has_next}])},[(0,a._)("a",{class:"page-link",href:"#",onClick:e[1]||(e[1]=(0,d.iM)((t=>c.updatePage(l.pages.current_page+1)),["prevent"]))},"Next")],2)])])}var u={name:"ThePagination",props:["pages"],methods:{updatePage(t){this.$emit("update-page",t)}}},c=l(89);const p=(0,c.Z)(u,[["render",i]]);var _=p},7425:function(t,e,l){l.r(e),l.d(e,{default:function(){return at}});var a=l(3396),s=l(7139),d=l(9242);const r={class:"container-fluid"},n={class:"table mt-3"},o=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"購買時間"),(0,a._)("th",null,"Email"),(0,a._)("th",null,"購買款項"),(0,a._)("th",null,"應付金額"),(0,a._)("th",null,"是否付款"),(0,a._)("th",null,"編輯")])],-1),i={class:"form-check form-switch"},u=["id","onUpdate:modelValue","onChange"],c=["for"],p=["for"],_={class:"btn-group btn-group-sm"},g=["onClick"],m=["onClick"];function h(t,e,l,h,b,w){const f=(0,a.up)("Loading"),y=(0,a.up)("OrderModal"),v=(0,a.up)("DelModal"),k=(0,a.up)("Pagination");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(f,{active:b.isLoading},null,8,["active"]),(0,a._)("div",r,[(0,a._)("table",n,[o,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(b.orderList,((e,l)=>((0,a.wg)(),(0,a.iD)("tr",{key:l},[(0,a._)("td",null,(0,s.zw)(t.$filter.date(e.create_at)),1),(0,a._)("td",null,(0,s.zw)(e.user.email),1),(0,a._)("td",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.products,((t,e)=>((0,a.wg)(),(0,a.iD)("ul",{class:"list-unstyled",key:e},[(0,a._)("li",null,[(0,a._)("strong",null,(0,s.zw)(t.product.title),1),(0,a.Uk)(" 數量 : "+(0,s.zw)(t.qty)+" "+(0,s.zw)(t.product.unit),1)])])))),128))]),(0,a._)("td",null,(0,s.zw)(t.$filter.currency(e.total)),1),(0,a._)("td",null,[(0,a._)("div",i,[(0,a.wy)((0,a._)("input",{type:"checkbox",class:"form-check-input",id:`${e.id}`,"onUpdate:modelValue":t=>e.is_paid=t,onChange:t=>w.updatePaid(e)},null,40,u),[[d.e8,e.is_paid]]),e.is_paid?((0,a.wg)(),(0,a.iD)("label",{key:0,for:`${e.id}`,class:"form-label"},"已付款",8,c)):((0,a.wg)(),(0,a.iD)("label",{key:1,for:`${e.id}`,class:"form-label"},"未付款",8,p))])]),(0,a._)("td",null,[(0,a._)("div",_,[(0,a._)("button",{type:"button",class:"btn btn-outline-primary",onClick:t=>w.openModal(e)},"檢視",8,g),(0,a._)("button",{type:"button",class:"btn btn-outline-danger",onClick:t=>w.openDelModal(e)},"刪除",8,m)])])])))),128))])])]),(0,a.Wm)(y,{orders:b.tempOrder,ref:"ordermodal"},null,8,["orders"]),(0,a.Wm)(v,{onDeleteProduct:w.delOrder,product:b.tempOrder,ref:"orderdelmodal"},null,8,["onDeleteProduct","product"]),(0,a.Wm)(k,{pages:b.pages,onUpdatePage:w.getOrders},null,8,["pages","onUpdatePage"])],64)}const b={class:"modal fade",id:"orderModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},w={class:"modal-dialog modal-xl"},f={class:"modal-content"},y=(0,a._)("div",{class:"modal-header bg-dark text-white"},[(0,a._)("h5",{class:"modal-title",id:"exampleModalLabel"},"訂單細節"),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),v={class:"modal-body"},k={class:"row"},O={class:"col-md-4"},D=(0,a._)("h3",{class:"h3"},"用戶資料",-1),x={class:"table"},z={key:0},$=(0,a._)("td",null,[(0,a._)("strong",null,"姓名")],-1),M=(0,a._)("td",null,[(0,a._)("strong",null,"Email")],-1),C=(0,a._)("td",null,[(0,a._)("strong",null,"電話")],-1),P=(0,a._)("td",null,[(0,a._)("strong",null,"地址")],-1),L={class:"col-md-8"},Z=(0,a._)("h3",{class:"h3"},"訂單細節",-1),U={class:"table"},H=(0,a._)("td",null,[(0,a._)("strong",null,"訂單編號")],-1),Y={style:{width:"400px"}},K=(0,a._)("td",null,[(0,a._)("strong",null,"下單時間")],-1),W=(0,a._)("td",null,[(0,a._)("strong",null,"付款時間")],-1),q={key:0},j={key:1},E=(0,a._)("td",null,[(0,a._)("strong",null,"付款狀態")],-1),V={key:0,class:"text-success"},N={key:1},T=(0,a._)("td",null,[(0,a._)("strong",null,"總金額")],-1),A=(0,a._)("h3",{class:"h3 mt-4"},"選購商品",-1),B={style:{width:"200px"}},F=(0,a._)("div",{class:"modal-footer"},[(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"關閉")],-1);function G(t,e,l,d,r,n){return(0,a.wg)(),(0,a.iD)("div",b,[(0,a._)("div",w,[(0,a._)("div",f,[y,(0,a._)("div",v,[(0,a._)("div",k,[(0,a._)("div",O,[D,(0,a._)("table",x,[r.tempOrders.user?((0,a.wg)(),(0,a.iD)("tbody",z,[(0,a._)("tr",null,[$,(0,a._)("td",null,(0,s.zw)(r.tempOrders.user.name),1)]),(0,a._)("tr",null,[M,(0,a._)("td",null,(0,s.zw)(r.tempOrders.user.email),1)]),(0,a._)("tr",null,[C,(0,a._)("td",null,(0,s.zw)(r.tempOrders.user.tel),1)]),(0,a._)("tr",null,[P,(0,a._)("td",null,(0,s.zw)(r.tempOrders.user.address),1)])])):(0,a.kq)("",!0)])]),(0,a._)("div",L,[Z,(0,a._)("table",U,[(0,a._)("tbody",null,[(0,a._)("tr",null,[H,(0,a._)("td",Y,(0,s.zw)(r.tempOrders.id),1)]),(0,a._)("tr",null,[K,(0,a._)("td",null,(0,s.zw)(t.$filter.date(r.tempOrders.create_at)),1)]),(0,a._)("tr",null,[W,r.tempOrders.paid_date?((0,a.wg)(),(0,a.iD)("td",q,(0,s.zw)(t.$filter.date(r.tempOrders.paid_date)),1)):((0,a.wg)(),(0,a.iD)("td",j,"時間不正確"))]),(0,a._)("tr",null,[E,r.tempOrders.is_paid?((0,a.wg)(),(0,a.iD)("td",V,"已付款")):((0,a.wg)(),(0,a.iD)("td",N,"尚未付款"))]),(0,a._)("tr",null,[T,(0,a._)("td",null,(0,s.zw)(t.$filter.currency(r.tempOrders.total)),1)]),A,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.tempOrders.products,((e,l)=>((0,a.wg)(),(0,a.iD)("tr",{key:l},[(0,a._)("td",null,[(0,a._)("strong",null,(0,s.zw)(e.product.title),1)]),(0,a._)("td",null,(0,s.zw)(e.qty)+" / "+(0,s.zw)(e.product.unit),1),(0,a._)("td",B,(0,s.zw)(t.$filter.currency(e.total)),1)])))),128))])])])])]),F])])],512)}var I=l(1933),J={props:{orders:{type:Object,default(){return{}}}},data(){return{modal:"",tempOrders:{}}},watch:{orders(){this.tempOrders=this.orders}},mixins:[I.Z]},Q=l(89);const R=(0,Q.Z)(J,[["render",G]]);var S=R,X=l(6769),tt=l(2534),et={data(){return{orderList:{},tempOrder:{},isPay:!1,isLoading:!1,pages:{}}},methods:{getOrders(t=1){const e=`https://vue3-course-api.hexschool.io/api/colpp61109/orders?page=${t}`;this.isLoading=!0,this.$http.get(e).then((t=>{this.orderList=t.data.orders,this.pages=t.data.pagination,this.isLoading=!1})).catch((()=>{}))},openModal(t){this.tempOrder={...t};const e=this.$refs.ordermodal;e.showModal()},openDelModal(t){this.tempOrder={...t};const e=this.$refs.orderdelmodal;e.showModal()},updatePaid(t){const e=`https://vue3-course-api.hexschool.io/api/colpp61109/pay/${t.id}`;this.isLoading=!0,this.$http.post(e).then((t=>{this.$pushMessage(t,"付款")})).catch((()=>{})),this.isLoading=!1},delOrder(t){const e=`https://vue3-course-api.hexschool.io/api/colpp61109/admin/order/${t}`;this.isLoading=!0;const l=this.$refs.orderdelmodal;this.$http.delete(e).then((()=>{this.getOrders(),l.hideModal()})).catch((()=>{})),this.isLoading=!1}},components:{OrderModal:S,DelModal:X.Z,Pagination:tt.Z},created(){this.getOrders()}};const lt=(0,Q.Z)(et,[["render",h]]);var at=lt}}]);
//# sourceMappingURL=439.74db18d1.js.map