"use strict";(self["webpackChunkvue_glasses"]=self["webpackChunkvue_glasses"]||[]).push([[490],{7490:function(t,e,l){l.r(e),l.d(e,{default:function(){return lt}});var a=l(3396),i=l(7139);const s={class:"row"},c={class:"col"},o={class:"text-end mt-4"},r={class:"table mt-4"},d=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{width:"120"},"建立時間"),(0,a._)("th",{width:"240"},"標題"),(0,a._)("th",{width:"120"},"作者"),(0,a._)("th",{width:"120"},"標籤"),(0,a._)("th",{width:"120"},"是否公開"),(0,a._)("th",{width:"120"},"編輯")])],-1),n={key:0,class:"text-success"},p={key:1,class:"text-muted"},m={class:"btn-group"},u=["onClick"],h=["onClick"];function _(t,e,l,_,b,f){const g=(0,a.up)("ArticlesModal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",s,[(0,a._)("div",c,[(0,a._)("div",o,[(0,a._)("button",{type:"button",class:"btn btn-outline-primary",onClick:e[0]||(e[0]=t=>f.openArticlesModal(!0))},"新增文章")]),(0,a._)("table",r,[d,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(b.articles,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",null,(0,i.zw)(t.$filter.date(e.create_at)),1),(0,a._)("td",null,(0,i.zw)(e.title),1),(0,a._)("td",null,(0,i.zw)(e.author),1),(0,a._)("td",null,(0,i.zw)(e.tag),1),e.isPublic?((0,a.wg)(),(0,a.iD)("td",n,"公開")):((0,a.wg)(),(0,a.iD)("td",p,"未公開")),(0,a._)("td",null,[(0,a._)("div",m,[(0,a._)("button",{type:"button",class:"btn btn-sm btn-outline-primary",onClick:t=>f.openArticlesModal(!1,e)},"編輯",8,u),(0,a._)("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:t=>f.deleteArticle(e.id)},"刪除",8,h)])])])))),128))])])])]),(0,a.Wm)(g,{article:b.tempArticle,ref:"articlemodal",onUpdateArticle:f.updateArticle},null,8,["article","onUpdateArticle"])],64)}var b=l(9242);const f={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},g={class:"modal-dialog modal-xl"},A={class:"modal-content"},w=(0,a._)("div",{class:"modal-header bg-dark text-white"},[(0,a._)("h5",{class:"modal-title",id:"exampleModalLabel"},"新增文章"),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),v={class:"modal-body"},y={class:"row"},x={class:"col-md-4"},U={class:"mb-3"},k=(0,a._)("label",{for:"img"},"輸入圖片網址",-1),$={class:"mb-3"},M=(0,a._)("label",{for:"imgUrl"},"或上傳圖片",-1),C=["src"],D={class:"col-md-8"},V={class:"row gx-2 mb-3"},I={class:"col-md-6 mb-3"},z=(0,a._)("label",{for:"titel"},"標題",-1),F={class:"col-md-6 mb-3"},N=(0,a._)("label",{for:"create_at"},"建立時間",-1),P={class:"row gx-2"},Z={class:"col-md-6 mb-3"},j=(0,a._)("label",{for:"tag"},"標籤",-1),H={class:"col-md-6 mb-3"},L=(0,a._)("label",{for:"author"},"作者",-1),O=(0,a._)("hr",null,null,-1),S={class:"mb-3"},T=(0,a._)("label",{for:"description"},"摘要",-1),Y={class:"mb-3"},B=(0,a._)("label",{for:"content"},"內容",-1),E={class:"mb-3"},K={class:"modal-footer"},W=(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function q(t,e,l,i,s,c){return(0,a.wg)(),(0,a.iD)("div",f,[(0,a._)("div",g,[(0,a._)("div",A,[w,(0,a._)("div",v,[(0,a._)("div",y,[(0,a._)("div",x,[(0,a._)("div",U,[k,(0,a.wy)((0,a._)("input",{type:"text",id:"img",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[0]||(e[0]=t=>s.tempArticle.imageUrl=t)},null,512),[[b.nr,s.tempArticle.imageUrl]])]),(0,a._)("div",$,[M,(0,a._)("input",{type:"file",id:"imgUrl",class:"form-control",onChange:e[1]||(e[1]=(...t)=>c.uploadFile&&c.uploadFile(...t)),ref:"fileInput"},null,544)]),(0,a._)("img",{class:"img-fluid",alt:"",src:s.tempArticle.imageUrl},null,8,C)]),(0,a._)("div",D,[(0,a._)("div",V,[(0,a._)("div",I,[z,(0,a.wy)((0,a._)("input",{type:"text",id:"title",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[2]||(e[2]=t=>s.tempArticle.title=t)},null,512),[[b.nr,s.tempArticle.title]])]),(0,a._)("div",F,[N,(0,a.wy)((0,a._)("input",{type:"date",id:"create_at",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=t=>s.create_at=t)},null,512),[[b.nr,s.create_at]])])]),(0,a._)("div",P,[(0,a._)("div",Z,[j,(0,a.wy)((0,a._)("input",{type:"text",id:"tag",class:"form-control",placeholder:"請輸入標籤","onUpdate:modelValue":e[4]||(e[4]=t=>s.tempArticle.tag=t)},null,512),[[b.nr,s.tempArticle.tag]])]),(0,a._)("div",H,[L,(0,a.wy)((0,a._)("input",{type:"text",id:"author",class:"form-control",placeholder:"請輸入作者","onUpdate:modelValue":e[5]||(e[5]=t=>s.tempArticle.author=t)},null,512),[[b.nr,s.tempArticle.author]])])]),O,(0,a._)("div",S,[T,(0,a.wy)((0,a._)("textarea",{type:"text",id:"description",class:"form-control",placeholder:"請輸入摘要","onUpdate:modelValue":e[6]||(e[6]=t=>s.tempArticle.description=t)},null,512),[[b.nr,s.tempArticle.description]])]),(0,a._)("div",Y,[B,(0,a.wy)((0,a._)("textarea",{type:"text",id:"content",class:"form-control",placeholder:"請輸入內容","onUpdate:modelValue":e[7]||(e[7]=t=>s.tempArticle.content=t)},null,512),[[b.nr,s.tempArticle.content]])]),(0,a._)("div",E,[(0,a.wy)((0,a._)("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":e[8]||(e[8]=t=>s.tempArticle.isPublic=t)},null,512),[[b.e8,s.tempArticle.isPublic]]),(0,a.Uk)(" 是否公開 ")])])])]),(0,a._)("div",K,[W,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:e[9]||(e[9]=e=>t.$emit("update-article",s.tempArticle))},"確認")])])])],512)}var G=l(1933),J={data(){return{modal:{},tempArticle:{},create_at:""}},props:{article:{type:Object,default(){return{}}}},watch:{article(){this.tempArticle=this.article;const t=new Date(1e3*this.tempArticle.create_at).toISOString().split("T");[this.create_at]=t},create_at(){this.tempArticle.create_at=Math.floor(new Date(this.create_at)/1e3)}},methods:{uploadFile(){const t=this.$refs.fileInput.files[0],e=this.$refs.fileInput.id,l=new FormData;l.append("file-to-upload",t);const a="https://vue3-course-api.hexschool.io/api/colpp61109/admin/upload";this.axios.post(a,l).then((t=>{t.data.success&&(this.tempArticle.imageUrl=t.data.imageUrl,document.getElementById(e).value="")})).catch((()=>{}))}},mixins:[G.Z]},Q=l(89);const R=(0,Q.Z)(J,[["render",q]]);var X=R,tt={data(){return{articles:[],tempArticle:{},isNew:!1,id:""}},inject:["emitter"],methods:{getArticles(t=1){const e=`https://vue3-course-api.hexschool.io/api/colpp61109/admin/articles?page=${t}`;this.$http.get(e).then((t=>{this.articles=t.data.articles})).catch((()=>{}))},openArticlesModal(t,e){const l=this.$refs.articlemodal;this.isNew=t,this.tempArticle=t?{create_at:(new Date).getTime()/1e3}:{...e},l.showModal()},updateArticle(t){this.tempArticle=t;const e=this.$refs.articlemodal;let l="https://vue3-course-api.hexschool.io/api/colpp61109/admin/article",a="post";this.isNew||(a="put",l=`https://vue3-course-api.hexschool.io/api/colpp61109/admin/article/${t.id}`),e.hideModal(),this.$http[a](l,{data:this.tempArticle}).then((t=>{t.data.success?(this.getArticles(),this.emitter.emit("push-message",{style:"success",title:"更新成功"})):this.emitter.emit("push-message",{style:"danger",title:"更新失敗"})})).catch((()=>{}))},deleteArticle(t){const e=`https://vue3-course-api.hexschool.io/api/colpp61109/admin/article/${t}`,l=this.$refs.articlemodal;l.hideModal(),this.$http.delete(e).then((()=>{this.getArticles()}))}},mounted(){this.getArticles(),this.id=this.$route.params.articleId},components:{ArticlesModal:X}};const et=(0,Q.Z)(tt,[["render",_]]);var lt=et}}]);
//# sourceMappingURL=490.3bc8a72d.js.map